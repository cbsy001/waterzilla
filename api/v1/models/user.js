const Joi = require('joi');
const mongoose = require('mongoose');

const userSchema = new mongoose.Schema({
    mail: {
        type: String,
        required: true,
        unique: true,
    },
    user: String,
    password: {
        type: String,
        required: true,
    },
    name: {
        type: String,
        required: true,
    },
    dateCreated: {
        type: Date,
        default: Date.now,
    },
    status: {
        type: String,
        default: "noaccess",
    },
    type: {
        type: String,
        default: "staff",
    },
    image: {
        type: String,
        default: "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4gHYSUNDX1BST0ZJTEUAAQEAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADb/2wBDACgcHiMeGSgjISMtKygwPGRBPDc3PHtYXUlkkYCZlo+AjIqgtObDoKrarYqMyP/L2u71////m8H////6/+b9//j/2wBDASstLTw1PHZBQXb4pYyl+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj/wAARCAHMAcwDASIAAhEBAxEB/8QAGQABAAMBAQAAAAAAAAAAAAAAAAIDBAUB/8QALRABAAIBAgMHAwQDAAAAAAAAAAECAxExBBIhE0FRUmFxkRQiMjOBobEjQmL/xAAYAQEAAwEAAAAAAAAAAAAAAAAAAQMEAv/EACARAQEAAgEFAQEBAAAAAAAAAAABAhEDEhMhMVFBMkL/2gAMAwEAAhEDEQA/AMICpaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJ02QTpsikQASAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACdNkE6bIpEAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnTZBOmyKRABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJ02QTpsikQASAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACdNkE6bIpEAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnTZBOmyKRABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJ02QTpsikQASAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACdNkE6bIpEAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACdcOS+1ZJLfSN6QGiOEvO81hL6P/v8Ah328vjnrx+so1/R/9/wjPB27rRPudvL4deLMLbcPkr/rr7dVWziyz26ll9AAkAAAAAAAATpsgnTZFIgAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFuLBbJ12r4yt4fh9dL3jp3Q1LsOLfmqsuTXiK8eCmPaNZ8ZWjybRWNZmIj1aJJPSm216KLcVjjbW3shPGeFP5c3kxn66mGV/GoZPrP+P5TrxdJ3iYROTH6dGTQhfHTJ+VYn1e0vW8fbaJSd+LHPmMWXhbV60+6PDvZ3VUZ+HjJ91elv7UZ8X7itx5PysI9mJidJjSYeKFwAAAAAAnTZBOmyKRABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANHDYeaee0fbG3qqx0nJeKx3ujWIrWIjaFvFhu7qvky14j0Gfic3Zxy1/Kf4aMspjN1RJu6e5uIjH9tetv6Y73tedbTqiMmWdyaccZiAOXQAD2JmJ1idJacPFf65PllHWOVx9ObjL7dTd6xcNm5Z5LT9s7eja14ZTKbZ8sems/E4eevNWPuj+WJ1WHisXJfmjaynlw/wBRZx5flUAKFwAAAAnTZBOmyKRABIAAAAAAD2ImZ0jrLVi4WN8nxDrHG5enNyk9s1aWvOlazK2vC5J30j3ltiIiNIjSHq+cM/VV5b+Mf0c+ePgng7d14+GwddrFz3MmC3C5I2iJ9pVWrNZ0tExPq6iNq1vGloiYcXhn46nLf1zBpy8LNdbY+seDMoyxuPtdLL6AEJAAAAAAAAAAAAANwbODppWbzvPSGlGleSkV8ISbcZ0zTLld3aN7RSk2naHOvab2m07y08ZfpWnj1lkZ+bLd0t45qbAFS0AAAAAAb+Gydpj6/lHSWBdw1+XNHhbo748tZOM5uN6vNTtMUx37wsGuzc0zy6coWZ68ma0d2uqths1dNUuwASAAJ02QTpsikQASAAAAANPCY+aZvPdsnHHqukZXU2uwYIxxrP5T/C4eTOkazs2yTGajLbbXqi/E46dI+6fRnz55yTpXpX+1KjPm/MVuPH9aZ4y3dSPl7HGT30j9pZRX3MvrvoxdDHxGPJOkTpPhK1ymnh+ImJil56d0+C3Dl34qvLj15jYzcTgiYm9Y698eLSLcsZlNVxLZduULuJx9nk6bT1hSx2aummXc2AISAAAAAAAAAALMFebNWPXVWv4SNc3tDrCbyjnLxK3ANrK5/E25s9vToqe2nW0z4y8Ybd3bXJqACEgAAAAAD2J0nWHgDqROsRPi9V8POuCnssbpdzbJfFY+Nr99beMaMzZxkf46z6sbJyzWTRx/yAOHYAAnTZBOmyKRABIAAAAOlipyY4r4MGGvNlrHq6S/hnuqeW/gy8Xk0iKR39ZanNzW5stp9XfLlrHTnjm6gAytAAAADdwuTnx6TvXovYOFty5ojx6N7Xx5bxZs5qqeJpz4Znvr1YHUmNYmJ73MmNJmJ7lXNPO1nFfGngClaAAAAAAAAAANPB/qW9mZo4P9S3s74/6jnP8AmtryekS9eNjK5YDA2AAAAAAAAAAN/C/oV/dcp4aP8Ff3XNuH8xly91Rxf6P7sLbxn6Me7Ez839LuP+QBUsAAE6bIJ02RSIAJAAAAF3Cx/nj2lvYeE/W/ZuauH+Wfk9vLTpWZ9HLdO/4W9pcxxzfjri/QBQuAAAASxzplrPrDpuZT86+7ptHD6qnl/Bzc0aZr+8uk52f9a/uc3qI4vasBnXgAAAAAAAAAC7hZ0zx6wpSx25clbeEpxurKjKbjpgNzI5mSOXJaPCUV/F15c2vdaFDDlNWxrxu4AISAAAAAAAlSvNeK+Mg6GGOXFWPRN49bpNTTJWXjZ+2serI0cZbXLEeEM7JyXeVaMJrEAcOwABOmyCdNkUiACQAAABbw06Z6ug5lLct4t4Tq6TRw3xYo5Z52T1jRzJjSZie51GDiacuaZ7rdTmnjZxXzpSAzrwAAAFmGObNSPV0WPg6a3m/dHRsaeGax2z8l8jmZJ1yWnxmXRyW5cdreEOY55r6jrinugChcAAAAAAAAAAAA6OC/PirPftKxj4TJpaaTtOzY2YZdWLLnNVRxVObFrG9erC6jn58fZ5JjunZVzY/6WceX4rAULgAAAAABp4Omt5vO0bM9aza0VjeXRx0jHSKwt4sd3avky1NJvJnSNZeqOKycuPljezTldTaiTd0x3tz3tbxlEGFrAAAAE6bIJ02RSIAJAAAABv4W/Pi0nevRgWYcs4r6907u+PLprjPHcdFVnxdrTSPyjZZExMRMbS9a7JZpnl1XKmNJ0kb83Dxk6x0t/bHfHfHP3Vn3ZMsLi0Y5zJABw7Htaze0VjeU8eG+SekaR4y2YcNcUdOs98rMOO5OMs5EsdIx0isJiN7xSs2naGrxIz+6o4y+lYpHf1ljSvecl5tPeix55dV204zU0AOXQAAAAAAAAAAAD2JmJiY3h0MOSMlInv74c5ZiyzivrG3fDvjz6a4zx6o6KGXHGSnLP7T4Pa2i9YtWdYlJr8WM/pzMmO2O2loRdO9K3rpaNYZMnC2r1p90eHezZ8VnpfjyS+2cezWazpaJj3eKlgBEa7APYiZnSI1lbThsl945Y9WvFhrijp1nxlZjx3JxlnIhw+Ds41t+U/wvHjVJJNRnttu6TMViZmdIhzsuScmSbd3ct4nPzzy1/GP5Z2blz34i/jx15oAqWAAAACdNkE6bIpEAEgAAAAAC/h8/Z/bbrX+m2JiY1idYctPHlvjn7Z6eC3Dl6fFV5Yb8x0hnpxdJ/OJrK2uSltrRP7tEyxvqqbjYTixzvSvwRjpG1Kx+ybxOojdeiFsuOu94U34uI6UjX1lFzxnupmNq+9q0rradIYc2actvCsbQhe9sk62nVFmz5Ll4i7HDXkAVrAAAAAAAAAAAAAAAAFmLLbFbWNu+G3HlrkjWs9fBznsTMTrE6Ssw5Li4ywmTqDHj4u0dLxzeq+ufHba0R79GjHkxqm4WLJiJ3hGcWOf9K/CW+z11qVztX2OPyV+E4rFdoiPZ6GpDdBC2XHTe0KL8XG1K/vLm54z2mY2tFrRSNbTpDHn4icn216V/tVe9rzradUVGfLcvEXY8cnmgCpYAAAAAAJ02QTpsikQASAAAAAAAAAAAAAAAAAAAvrwt7Vi0Wr1jV79HfzVddvL4568WcaPo7+ap9HfzVT28vh14/WcaPo7+ap9HfzVO3l8OvH6zjR9HfzVPo7+ap28vh14/WcaPo7+ap9HfzVO3l8OvH6zjR9HfzVPo7+ap28vh14/WcW5cFsVeaZieunRU5ss8VMsvoAQkAAAB7EzG06Jdrk89vlANo0n2uTz2+UZtad5mfeXgbpoAEgAAAAAAAAACdNkE6bIpEAEgAAAAAAAAAAAAAAAAADfjy44xUib11iI70+2x+evy5ounNfirtx0u2x+evydtj89flzQ71+Hajpdtj89fk7bH56/Lmh3r8O1HS7bH56/J22Pz1+XNDvX4dqOl22Pz1+Ttsfnr8uaHevw7UdLtsfnr8nbY/PX5c0O9fh2o18VelsURW0TOvdLICvLLqu3eM1NADl0AAAAAAAAAAAAAAAAAAAAJ02QTpsikQASAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACdNkE6bIpEAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnTZBOmyKRABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJ02QTpsikQASAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACdNkE6bIpEAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnTZBOmyKRABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJ02QTpsikQASAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACdNkE6bIpEAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnTZBOmyKRABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJ02QTpsikf/Z",
    },
});

userSchema.methods.getUserFullName = function () {
    return `${this.name}`;
};

userSchema.methods.isInformation = function () {
    return `${this.status}`;
};

const Users = mongoose.model('User', userSchema);

const sampleUsers = [{
    mail: "87295854+trngbro@users.noreply.github.com",
    user: "admin",
    password: "513da788167a5218-14b5cfd8430025b2",
    name: "Trung-Nghia Nguyen",
    status: "active",
    type: "admin"
}]

Users.insertMany(sampleUsers)
    .then(() => {
        console.log("Users data are inserted.");
    })
    .catch((error) => {

    });

const validate = (user) => {
    const schema = Joi.object({
        name: Joi.string().min(3).max(255).required(),
        mail: Joi.string().email().required(),
        type: Joi.string().valid('staff', 'admin').required()
    });
    return schema.validate(user);
};

module.exports = {
    Users,
    validate
};